{"ast":null,"code":"import _regeneratorRuntime from\"/home/prada/Documents/acalution-assignment/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/home/prada/Documents/acalution-assignment/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/home/prada/Documents/acalution-assignment/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/prada/Documents/acalution-assignment/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useEffect,useState}from'react';import axios from'axios';import{BASE_URL}from'../../constants';// https://zax5j10412.execute-api.ap-southeast-1.amazonaws.com/dev/api/product/list?page=${currentPage}\n// https://zax5j10412.execute-api.ap-southeast-1.amazonaws.com/dev/api/product/${id}\nvar useProductList=function useProductList(page){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),productList=_useState2[0],setProductList=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),totalPage=_useState4[0],setTotalPage=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),visibleModalError=_useState6[0],setVisibleModalError=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),loading=_useState8[0],setLoading=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),error=_useState10[0],setError=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),errorMessage=_useState12[0],setErrorMessage=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),loadMore=_useState14[0],setLoadMore=_useState14[1];var handleCloseError=function handleCloseError(){return setVisibleModalError(false);};// console.log('product list', productList)\nuseEffect(function(){getProductList(page);},[page]);var getProductList=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(page){var params,res,products;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoading(true);setError(false);_context.prev=2;params={page:page};_context.next=6;return axios.get(\"\".concat(BASE_URL,\"/list?page=\").concat(params.page));case 6:res=_context.sent;if(res.status===200){products=res.data.value.products;setTotalPage(Math.ceil(res.data.value.totalCount/20));setProductList(function(prevProductList){return[].concat(_toConsumableArray(prevProductList),_toConsumableArray(products));});setLoadMore(page!==totalPage);// check if there's still data to load\nsetLoading(false);}_context.next=16;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](2);setError(true);setErrorMessage(_context.t0);setVisibleModalError(true);setLoading(false);case 16:case\"end\":return _context.stop();}}},_callee,null,[[2,10]]);}));return function getProductList(_x){return _ref.apply(this,arguments);};}();return{productList:productList,handleCloseError:handleCloseError,visibleModalError:visibleModalError,errorMessage:errorMessage,loading:loading,error:error,loadMore:loadMore,totalPage:totalPage};};export default useProductList;","map":{"version":3,"sources":["/home/prada/Documents/acalution-assignment/src/components/productlist/product-list.hooks.js"],"names":["useEffect","useState","axios","BASE_URL","useProductList","page","productList","setProductList","totalPage","setTotalPage","visibleModalError","setVisibleModalError","loading","setLoading","error","setError","errorMessage","setErrorMessage","loadMore","setLoadMore","handleCloseError","getProductList","params","get","res","status","products","data","value","Math","ceil","totalCount","prevProductList"],"mappings":"yoBAAA,OAAQA,SAAR,CAAmBC,QAAnB,KAAmC,OAAnC,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,QAAT,KAAyB,iBAAzB,CACA;AACA;AAEA,GAAMC,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,CAACC,IAAD,CAAU,eACOJ,QAAQ,CAAC,EAAD,CADf,wCACxBK,WADwB,eACXC,cADW,8BAEGN,QAAQ,CAAC,CAAD,CAFX,yCAExBO,SAFwB,eAEbC,YAFa,8BAGmBR,QAAQ,CAAC,KAAD,CAH3B,yCAGxBS,iBAHwB,eAGLC,oBAHK,8BAIDV,QAAQ,CAAC,KAAD,CAJP,yCAIxBW,OAJwB,eAIfC,UAJe,8BAKLZ,QAAQ,CAAC,KAAD,CALH,0CAKxBa,KALwB,gBAKjBC,QALiB,gCAMSd,QAAQ,CAAC,EAAD,CANjB,2CAMxBe,YANwB,gBAMVC,eANU,gCAOChB,QAAQ,CAAC,KAAD,CAPT,2CAOxBiB,QAPwB,gBAOdC,WAPc,gBAQ/B,GAAMC,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,SAAMT,CAAAA,oBAAoB,CAAC,KAAD,CAA1B,EAAzB,CACA;AAEAX,SAAS,CAAC,UAAM,CACdqB,cAAc,CAAChB,IAAD,CAAd,CACD,CAFQ,CAEN,CAACA,IAAD,CAFM,CAAT,CAGA,GAAMgB,CAAAA,cAAc,0FAAG,iBAAOhB,IAAP,0IACrBQ,UAAU,CAAC,IAAD,CAAV,CACAE,QAAQ,CAAC,KAAD,CAAR,CAFqB,gBAIbO,MAJa,CAIJ,CACbjB,IAAI,CAAEA,IADO,CAJI,uBAODH,CAAAA,KAAK,CAACqB,GAAN,WAAapB,QAAb,uBAAmCmB,MAAM,CAACjB,IAA1C,EAPC,QAObmB,GAPa,eAQnB,GAAIA,GAAG,CAACC,MAAJ,GAAe,GAAnB,CAAwB,CAChBC,QADgB,CACLF,GAAG,CAACG,IAAJ,CAASC,KAAT,CAAeF,QADV,CAEtBjB,YAAY,CAACoB,IAAI,CAACC,IAAL,CAAUN,GAAG,CAACG,IAAJ,CAASC,KAAT,CAAeG,UAAf,CAA4B,EAAtC,CAAD,CAAZ,CACAxB,cAAc,CAAC,SAAAyB,eAAe,CAAI,CAChC,mCAAWA,eAAX,qBAA+BN,QAA/B,GACD,CAFa,CAAd,CAGAP,WAAW,CAACd,IAAI,GAAKG,SAAV,CAAX,CAAgC;AAChCK,UAAU,CAAC,KAAD,CAAV,CACD,CAhBkB,iFAkBnBE,QAAQ,CAAC,IAAD,CAAR,CACAE,eAAe,aAAf,CACAN,oBAAoB,CAAC,IAAD,CAApB,CACAE,UAAU,CAAC,KAAD,CAAV,CArBmB,qEAAH,kBAAdQ,CAAAA,cAAc,4CAApB,CAwBA,MAAO,CACLf,WAAW,CAAXA,WADK,CACOc,gBAAgB,CAAhBA,gBADP,CACyBV,iBAAiB,CAAjBA,iBADzB,CAELM,YAAY,CAAZA,YAFK,CAESJ,OAAO,CAAPA,OAFT,CAEkBE,KAAK,CAALA,KAFlB,CAEyBI,QAAQ,CAARA,QAFzB,CAEmCV,SAAS,CAATA,SAFnC,CAAP,CAID,CA1CD,CA4CA,cAAeJ,CAAAA,cAAf","sourcesContent":["import {useEffect, useState } from 'react'\nimport axios from 'axios'\nimport { BASE_URL } from '../../constants'\n// https://zax5j10412.execute-api.ap-southeast-1.amazonaws.com/dev/api/product/list?page=${currentPage}\n// https://zax5j10412.execute-api.ap-southeast-1.amazonaws.com/dev/api/product/${id}\n\nconst useProductList = (page) => {\n  const [productList, setProductList] = useState([])\n  const [totalPage, setTotalPage] = useState(0)\n  const [visibleModalError, setVisibleModalError] = useState(false)\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState(false)\n  const [errorMessage, setErrorMessage] = useState('')\n  const [loadMore, setLoadMore] = useState(false)\n  const handleCloseError = () => setVisibleModalError(false)\n  // console.log('product list', productList)\n\n  useEffect(() => {\n    getProductList(page)\n  }, [page])\n  const getProductList = async (page) => {\n    setLoading(true)\n    setError(false)\n    try {\n      const params = {\n        page: page,\n      }\n      const res = await axios.get(`${BASE_URL}/list?page=${params.page}`)\n      if (res.status === 200) {\n        const products = res.data.value.products\n        setTotalPage(Math.ceil(res.data.value.totalCount / 20))\n        setProductList(prevProductList => {\n          return [...prevProductList, ...products]\n        })\n        setLoadMore(page !== totalPage) // check if there's still data to load\n        setLoading(false)\n      }\n    } catch (error) {\n      setError(true)\n      setErrorMessage(error)\n      setVisibleModalError(true)\n      setLoading(false)\n    }\n  }\n  return {\n    productList,handleCloseError, visibleModalError,\n    errorMessage, loading, error, loadMore, totalPage\n  }\n}\n\nexport default useProductList"]},"metadata":{},"sourceType":"module"}